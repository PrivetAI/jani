<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jani Analytics</title>
    <link rel="stylesheet" href="/static/style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="app">
        <header>
            <h1>üìä Jani Analytics</h1>
            <div class="header-controls">
                <select id="backupSelect">
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –±—ç–∫–∞–ø...</option>
                </select>
                <label class="upload-btn">
                    üì§ –ó–∞–≥—Ä—É–∑–∏—Ç—å –±—ç–∫–∞–ø
                    <input type="file" id="uploadInput" accept=".sql,.sql.gz,.gz" hidden>
                </label>
            </div>
        </header>

        <div id="loading" class="loading hidden">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
        
        <main id="dashboard" class="hidden">
            <!-- Overview -->
            <section class="overview">
                <div class="stat-card">
                    <span class="stat-value" id="totalUsers">-</span>
                    <span class="stat-label">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</span>
                </div>
                <div class="stat-card">
                    <span class="stat-value" id="totalMessages">-</span>
                    <span class="stat-label">–°–æ–æ–±—â–µ–Ω–∏–π</span>
                </div>
                <div class="stat-card">
                    <span class="stat-value" id="totalCharacters">-</span>
                    <span class="stat-label">–ü–µ—Ä—Å–æ–Ω–∞–∂–µ–π</span>
                </div>
                <div class="stat-card">
                    <span class="stat-value" id="totalRevenue">-</span>
                    <span class="stat-label">–î–æ—Ö–æ–¥ (stars)</span>
                </div>
                <div class="stat-card">
                    <span class="stat-value" id="conversionRate">-</span>
                    <span class="stat-label">–ö–æ–Ω–≤–µ—Ä—Å–∏—è</span>
                </div>
            </section>

            <!-- Tabs -->
            <nav class="tabs">
                <button class="tab active" data-tab="users">üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</button>
                <button class="tab" data-tab="messages">üí¨ –°–æ–æ–±—â–µ–Ω–∏—è</button>
                <button class="tab" data-tab="characters">üé≠ –ü–µ—Ä—Å–æ–Ω–∞–∂–∏</button>
                <button class="tab" data-tab="financial">üí∞ –§–∏–Ω–∞–Ω—Å—ã</button>
                <button class="tab" data-tab="referrals">üîó –†–µ—Ñ–µ—Ä–∞–ª—ã</button>
                <button class="tab" data-tab="compare">üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ</button>
            </nav>

            <!-- Users Tab -->
            <div id="users-tab" class="tab-content active">
                <div class="grid-2">
                    <div class="card">
                        <h3>–°–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è</h3>
                        <div class="metrics">
                            <div class="metric"><span class="label">–í—Å–µ–≥–æ:</span><span id="usersTotal">-</span></div>
                            <div class="metric"><span class="label">Premium:</span><span id="usersPremium">-</span></div>
                            <div class="metric"><span class="label">Free:</span><span id="usersFree">-</span></div>
                            <div class="metric"><span class="label">18+ –ø–æ–¥—Ç–≤.:</span><span id="usersAdult">-</span></div>
                            <div class="metric"><span class="label">–ü–æ —Ä–µ—Ñ–µ—Ä–∞–ª—É:</span><span id="usersReferred">-</span></div>
                        </div>
                    </div>
                    <div class="card">
                        <h3>–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å (DAU/WAU/MAU)</h3>
                        <div class="metrics">
                            <div class="metric"><span class="label">DAU:</span><span id="dau">-</span></div>
                            <div class="metric"><span class="label">WAU:</span><span id="wau">-</span></div>
                            <div class="metric"><span class="label">MAU:</span><span id="mau">-</span></div>
                        </div>
                    </div>
                </div>
                <div class="grid-2">
                    <div class="card">
                        <h3>–Ø–∑—ã–∫–∏</h3>
                        <canvas id="languagesChart"></canvas>
                    </div>
                    <div class="card">
                        <h3>–ù–æ–≤—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</h3>
                        <canvas id="newUsersChart"></canvas>
                    </div>
                </div>
                <div class="card">
                    <h3>Retention (–∫–æ–≥–æ—Ä—Ç—ã –ø–æ –Ω–µ–¥–µ–ª—è–º)</h3>
                    <table id="retentionTable" class="data-table">
                        <thead>
                            <tr><th>–ù–µ–¥–µ–ª—è</th><th>Users</th><th>D1</th><th>D7</th><th>D30</th></tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>

            <!-- Messages Tab -->
            <div id="messages-tab" class="tab-content">
                <div class="grid-2">
                    <div class="card">
                        <h3>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π</h3>
                        <div class="metrics">
                            <div class="metric"><span class="label">–í—Å–µ–≥–æ:</span><span id="messagesTotal">-</span></div>
                            <div class="metric"><span class="label">–û—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:</span><span id="messagesUser">-</span></div>
                            <div class="metric"><span class="label">–°—Ä–µ–¥–Ω–µ–µ (–≤—Å–µ):</span><span id="avgMsgsAll">-</span></div>
                            <div class="metric highlight"><span class="label">–°—Ä–µ–¥–Ω–µ–µ (free):</span><span id="avgMsgsFree">-</span></div>
                            <div class="metric highlight"><span class="label">–°—Ä–µ–¥–Ω–µ–µ (premium):</span><span id="avgMsgsPremium">-</span></div>
                            <div class="metric"><span class="label">–°—Ä–µ–¥. —Ç–æ–∫–µ–Ω–æ–≤:</span><span id="avgTokens">-</span></div>
                        </div>
                    </div>
                    <div class="card">
                        <h3>–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π</h3>
                        <canvas id="msgsDistributionChart"></canvas>
                    </div>
                </div>
                <div class="grid-2">
                    <div class="card">
                        <h3>–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ —á–∞—Å–∞–º</h3>
                        <canvas id="hourlyChart"></canvas>
                    </div>
                    <div class="card">
                        <h3>–ú–æ–¥–µ–ª–∏ LLM</h3>
                        <canvas id="modelsChart"></canvas>
                    </div>
                </div>
                <div class="card">
                    <h3>–°–æ–æ–±—â–µ–Ω–∏—è –ø–æ –¥–Ω—è–º</h3>
                    <canvas id="msgsByDayChart"></canvas>
                </div>
            </div>

            <!-- Characters Tab -->
            <div id="characters-tab" class="tab-content">
                <div class="card">
                    <h3>üß™ A/B –¢–µ—Å—Ç: Prompt v1 vs v2</h3>
                    <table id="abTestTable" class="data-table">
                        <thead>
                            <tr>
                                <th>–í–µ—Ä—Å–∏—è</th>
                                <th>–ü–µ—Ä—Å–æ–Ω–∞–∂–µ–π</th>
                                <th>–°–æ–æ–±—â–µ–Ω–∏–π</th>
                                <th>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</th>
                                <th>–°—Ä–µ–¥. —Å–æ–æ–±—â./—é–∑–µ—Ä</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
                <div class="grid-2">
                    <div class="card">
                        <h3>–†–µ–π—Ç–∏–Ω–≥–∏ –ø–æ –≤–µ—Ä—Å–∏–∏ –ø—Ä–æ–º–ø—Ç–∞</h3>
                        <table id="ratingsTable" class="data-table">
                            <thead>
                                <tr><th>–í–µ—Ä—Å–∏—è</th><th>–õ–∞–π–∫–∏</th><th>–î–∏–∑–ª–∞–π–∫–∏</th><th>% –ª–∞–π–∫–æ–≤</th></tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                    <div class="card">
                        <h3>–≠–º–æ—Ü–∏–∏ –ø–æ –≤–µ—Ä—Å–∏–∏</h3>
                        <canvas id="emotionalChart"></canvas>
                    </div>
                </div>
                <div class="grid-2">
                    <div class="card">
                        <h3>UGC vs Official</h3>
                        <canvas id="ugcChart"></canvas>
                    </div>
                    <div class="card">
                        <h3>–¢–æ–ø –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π</h3>
                        <table id="topCharsTable" class="data-table small">
                            <thead>
                                <tr><th>–ò–º—è</th><th>–°–æ–æ–±—â.</th><th>–Æ–∑–µ—Ä–æ–≤</th><th>v</th></tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Financial Tab -->
            <div id="financial-tab" class="tab-content">
                <div class="grid-2">
                    <div class="card">
                        <h3>–§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏</h3>
                        <div class="metrics">
                            <div class="metric"><span class="label">–û–±—â–∏–π –¥–æ—Ö–æ–¥:</span><span id="finRevenue">-</span> ‚≠ê</div>
                            <div class="metric"><span class="label">–ü–ª–∞—Ç—è—â–∏—Ö —é–∑–µ—Ä–æ–≤:</span><span id="finPaying">-</span></div>
                            <div class="metric"><span class="label">ARPU:</span><span id="finArpu">-</span> ‚≠ê</div>
                            <div class="metric"><span class="label">ARPPU:</span><span id="finArppu">-</span> ‚≠ê</div>
                            <div class="metric"><span class="label">–ö–æ–Ω–≤–µ—Ä—Å–∏—è:</span><span id="finConversion">-</span>%</div>
                            <div class="metric"><span class="label">–ê–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–¥–ø–∏—Å–æ–∫:</span><span id="finActiveSubs">-</span></div>
                        </div>
                    </div>
                    <div class="card">
                        <h3>–ü–æ —Ç–∞—Ä–∏—Ñ–∞–º</h3>
                        <canvas id="tierChart"></canvas>
                    </div>
                </div>
                <div class="grid-2">
                    <div class="card">
                        <h3>–°—Ç–∞—Ç—É—Å—ã –ø–ª–∞—Ç–µ–∂–µ–π</h3>
                        <canvas id="paymentStatusChart"></canvas>
                    </div>
                    <div class="card">
                        <h3>–î–æ—Ö–æ–¥ –ø–æ –¥–Ω—è–º</h3>
                        <canvas id="revenueByDayChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Referrals Tab -->
            <div id="referrals-tab" class="tab-content">
                <div class="grid-2">
                    <div class="card">
                        <h3>–†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞</h3>
                        <div class="metrics">
                            <div class="metric"><span class="label">–ü—Ä–∏–≥–ª–∞—à–µ–Ω–æ:</span><span id="refTotal">-</span></div>
                            <div class="metric"><span class="label">–ê–∫—Ç–∏–≤–Ω—ã—Ö —Ä–µ—Ñ–µ—Ä–µ—Ä–æ–≤:</span><span id="refActive">-</span></div>
                            <div class="metric"><span class="label">–°—Ç–∞–ª–∏ –ø–ª–∞—Ç—è—â–∏–º–∏:</span><span id="refPaying">-</span></div>
                            <div class="metric"><span class="label">–ö–æ–Ω–≤–µ—Ä—Å–∏—è —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤:</span><span id="refConversion">-</span>%</div>
                        </div>
                    </div>
                    <div class="card">
                        <h3>–¢–æ–ø —Ä–µ—Ñ–µ—Ä–µ—Ä–æ–≤</h3>
                        <table id="topReferrersTable" class="data-table">
                            <thead>
                                <tr><th>Username</th><th>–ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–π</th></tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>
                <div class="card">
                    <h3>–ù–∞–≥—Ä–∞–¥—ã</h3>
                    <table id="rewardsTable" class="data-table">
                        <thead>
                            <tr><th>–¢–∏–ø</th><th>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ</th><th>–°–æ–æ–±—â–µ–Ω–∏–π –≤—ã–¥–∞–Ω–æ</th></tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>

            <!-- Compare Tab -->
            <div id="compare-tab" class="tab-content">
                <div class="card">
                    <h3>–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –±—ç–∫–∞–ø–æ–≤</h3>
                    <div class="compare-controls">
                        <select id="compareBackup1"><option value="">–ë—ç–∫–∞–ø 1...</option></select>
                        <span>vs</span>
                        <select id="compareBackup2"><option value="">–ë—ç–∫–∞–ø 2...</option></select>
                        <button id="compareBtn">–°—Ä–∞–≤–Ω–∏—Ç—å</button>
                    </div>
                    <div id="compareResult" class="hidden">
                        <table class="data-table">
                            <thead>
                                <tr><th>–ú–µ—Ç—Ä–∏–∫–∞</th><th>–ë—ç–∫–∞–ø 1</th><th>–ë—ç–∫–∞–ø 2</th><th>–ò–∑–º–µ–Ω–µ–Ω–∏–µ</th></tr>
                            </thead>
                            <tbody id="compareTableBody"></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </main>

        <div id="noData" class="no-data">
            <p>–ó–∞–≥—Ä—É–∑–∏—Ç–µ SQL –±—ç–∫–∞–ø –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏</p>
        </div>
    </div>

    <script src="/static/app.js"></script>
</body>
</html>
